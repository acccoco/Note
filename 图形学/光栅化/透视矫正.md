**透视矫正的背景**：
在「framebuffer space/screen space」中有一个三角形，已知三角形三个顶点的属性值，如何得到三角形内任意一点的属性值？用插值，如何确保插值相对于「world space」是线性的？

**「透视矫正」的作用**：
透视矫正的作用就是，根据「screen space」中的线性插值系数，得到「view space」中的线性插值系数。
透视变换的示意图：
![[图形学/光栅化/_attachments/u8e5ffa29_Pasted Graphic.png | 397]]
其中：$I$  表示对应点处的属性值
> 注：$s$ 是「screen space」中的线性插值系数，虽然是线性的，但我们想要的是「view space」或「world space」中的线性插值系数 $t$ 。


**透视矫正的表达式**：
![[图形学/光栅化/_attachments/u23031290_Pasted Graphic 4.png | 338]]
> 推导过程不是很直观，这里不写了。直接去看 "Perspective-Correct Interpolation, Kok-Lim Low"

$$I_P = Z_P
\begin{bmatrix}
\frac{I_A}{Z_A} && \frac{I_B}{Z_B} && \frac{I_C}{Z_C}
\end{bmatrix}
\begin{bmatrix}
u \\ v \\ 1-u-v
\end{bmatrix}$$
其中：

- $Z_A,\ Z_B, \cdots$  是顶点在「view space」中相对于摄像机的深度值
- $u,\ v$  是点在「screen space」中的线性插值系数（也就是在「screen space」中的三角重心坐标插值系数）

三角形内一点，在「view space」中相对于摄像机的深度值可以这样计算得到：
$$\frac{1}{Z_P} = 
\begin{bmatrix}
\frac{1}{Z_A} && \frac{1}{Z_B} && \frac{1}{Z_C}
\end{bmatrix}
\begin{bmatrix}
r \\ s \\ 1-r-s
\end{bmatrix}$$
其中：$r,\ s$ 是在「screen space」中的线性插值系数。
> 回忆透视变换矩阵，「clip space」坐标的 $w$ 分量就等于「view space」中顶点到摄像机的深度。


