
### 低差异序列
简单理解就是：差异度较低的序列。
低差异序列并不是「随机」的，也不是「伪随机」的，但是有一些和随机相关的性质，可以当成 $U(0,\ 1)$ 分布的随机变量序列来使用。

**差异的定义**：
![[图形学/misc/_attachments/ud1e27cdb_ACB;Py.png | 476]]
可以看出，序列内的点分布得越均匀，差异度就越低。

**为什么需要低差异序列**：
根据 Koksma-Hlawka 不等式，「拟蒙特卡洛」数值积分的「差error」取决于序列的差异度。

**通过 Van Der Corput 的 radical inverse 运算生成低差异序列**：
具体过程为：首先将一个整数表示成二进制数，然后镜像到小数点右边。
例如：`35`表示为二进制数为 `100011`，镜像到小数点右边得到 `0.110001`，用十进制表示也就是 `0.765625`
`glsl`的代码如下：
![[图形学/misc/_attachments/u85a782c7_image.png | 503]]

VDC 方法的优点是，后生成的样本点总是落在先前样本点最不密集的地方，确保总体较为均匀。
如下图所示：横轴表示第几个样本点，纵轴表示样本点的值。
![[图形学/misc/_attachments/ufe72cde4_image.png | 246]]

**二维低差异序列**：
VDC 方法可以得到一维的低差异序列，可以基于这种方法得到高纬度的低差异序列。

- Halton 方法：每个维度都选用不同的进制数（质数），使用 VDC 方法生成
- Hammersley 方法：第一个维度等于 $\frac{i}{N}$ ，后续维度和 Halton 方法相同，选用不同的进制数用 VDC 方法生成

以二维序列为例：
![[图形学/misc/_attachments/ufbafd48e_image.png | 500]]
Hammersley 方法的优点是，二维序列的生成非常快，且差异度更小。缺点是需要事先知道序列的总长度 $N$ 。


### 参考

- 文刀秋二：低差异序列（一）- 常见序列的定义及性质 [https://zhuanlan.zhihu.com/p/20197323](https://zhuanlan.zhihu.com/p/20197323)
- wiki
