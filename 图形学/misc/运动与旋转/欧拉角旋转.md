---
tag: 欧拉角
---

> [!info] 
> 在讨论欧拉角之前，应该明确旋转轴以及旋转顺序。

### 摄像机的欧拉角

欧拉角有很多中定义，这里，为了和「view space」一致，选择 y-x-z (intrinsic)形式的欧拉角。

定义如下：

- 世界坐标系是右手系
- 固定于摄像机上的坐标系是右手系，摄像机朝向 $-z$ 方向，摄像机正上方为 $+y$ 方向。
- 欧拉角为 $(\alpha,\ \beta,\ \gamma)$ 。初始状态 $(0,\ 0,\ 0)$，两个坐标系是重合的
- 用运动的方式描述这个欧拉角：
    - 先沿着世界坐标系的 $y$ 轴旋转 $\alpha$ 角度（偏航）
    - 在沿着局部坐标系的 $X$ 轴旋转 $\beta$ 角度（俯仰）
    - 最后沿着局部坐标系的 $Z$ 轴旋转 $\gamma$ 角度（桶滚）


![[图形学/misc/_attachments/Pasted image 20221105032731.png|250]]


欧拉角的角度范围：

- 沿着世界坐标系的 $y$ 轴旋转 $\alpha$，因此 $a\in[0,\ 2\pi)$ 
- 俯仰角度 $\beta$ ，限制角度范围为 $\beta \in (-\pi/2,\ \pi/2)$ 
- 桶滚角度 $\gamma$ ，一般不使用这个角度，保持为 $0$ 即可


#### 摄像机的 front 向量

摄像机的 front 向量是指摄像机朝向的方向。

由于 intrinsic 形式的 y-x-z 欧拉角和 extrinsic 形式的 z-x-y 欧拉角是等价的，因此可以通过如下步骤得到摄像机的 front 向量：

- 开始时，front 向量就是 $-z$，既 $(0,\ 0,\ -1)$ 
- 沿着世界坐标系的 $z$ 轴旋转 $\gamma$ 角度：忽略桶滚，$\gamma = 0$  
- 再沿着世界坐标系的 $x$ 轴旋转 $\beta$ 角度
- 最后沿着世界坐标系的 $y$ 轴旋转 $\alpha$ 角度

示意图如下：

![[图形学/misc/_attachments/Pasted image 20221105035601.png|250]]

front 向量的表达式为：
$$front=(-\cos\beta \sin\alpha,\ \sin\beta,\ -\cos\beta \cos\alpha)$$


---

### 欧拉角的完整定义

我对欧拉角的理解：欧拉角是==**两个坐标系**==之间的欧拉角。

>[!not] 注：在图形学中
> 一个坐标系可以是「世界坐标系」，另一个坐标系是「局部坐标系」。
> 世界坐标系是固定的，局部坐标系是固定在物体身上的。

根据 wikipedia 的参考，欧拉角有两种定义：
- proper euler angles (_z_-_x_-z, _x_-_y_-_x_, _y_-_z_-_y_, _z_-_y_-_z_, _x_-_z_-_x_, _y_-_x_-_y_)
- Tait-Bryan angles (_x_-_y_-_z_, _y_-_z_-_x_, _z_-_x_-_y_, _x_-_z_-_y_, _z_-_y_-_x_, _y_-_x_-_z_)

两种定义的区别是：Tait-Bryan 形式的三个转轴的符号都不同。


欧拉角既可以通过几何的形式定义（测量两个坐标系之间的角度差异），又可以通过运动的方式定义。

>[!note] 符号定义
> $xyz$ 坐标是是固定的世界坐标系；$XYZ$ 坐标系是固定在物体身上的局部坐标系。
> 开始时，世界坐标系和局部坐标系是重合的。


某两种欧拉角的定义如下：

|                       | Proper Euler angles (intrinsic)                                   | Tait-Bryan angles (intrinsic)                                      |
| --------------------- | ----------------------------------------------------------------- | ------------------------------------------------------------------ |
| 示意图                | ![[图形学/misc/_attachments/1063px-Eulerangles.svg.png\|200]] | ![[图形学/misc/_attachments/1225px-Taitbrianzyx.svg.png\|200]] |
| line of Nodes(N) 节线 | 是 $xy$ 与 $XY$ 的交线                                            | 是 $xy$ 与 $YZ$ 的交线（也可以是 $XZ$）                            |
| 旋转顺序              | z-x-z                                                             | z-y-x                                                              |


#### intrinsic rotations 约定和 extrinsic rotations 约定

**intrinsic rotations** 是指：参与旋转的转轴，只有局部坐标系的转轴 $X,\ Y,\ Z$ 。

以 z-y-z 为例，用运动的形式来描述这个欧拉角：
- 先绕着 $Z$ 轴旋转 $\varphi$ 角度（注意，初始时局部坐标系的 $Z$ 轴和世界坐标系的 $z$ 轴是重合的）
- 再绕着 $Y$ 轴旋转 $\theta$ 角度
- 最后绕着 $Z$ 轴旋转 $\psi$ 角度

**extrinsic rotations** 是指：参与旋转的转轴只有世界坐标系 $x,\ y,\ z$ 

>[!note] 两种约定之间的转换
> 以 Tait-Bryan angles 为例，只需要颠倒旋转的顺序，就可以实现 intrinsic 和 extrinsic 之间的转换
> 例如：以下两种表示是等价的
> - intrinsic 的顺序 Z($\psi$) - Y($\theta$) - X($\varphi$) 
> - extrinsic 的顺序 x($\varphi$) - y($\theta$) - z($\psi$)


#### yaw-pitch-roll 形式

使用 intrinsic rotations 约定描述的 z-y-x 旋转（Tait-Bryan angles）比较通用，三次旋转的角度分别被称为 yaw, pitch 和 roll

如下图所示：
- $\psi$ 就是偏航角 yaw，绕世界坐标系 $z$ 轴旋转 $\psi$ 角度
- $\theta$ 是俯仰角度 pitch，绕局部坐标系的 $Y$ 轴旋转 $\theta$ 角度
- $\varphi$ 是桶滚角度 roll，绕局部坐标系的 $Z$ 轴旋转 $\varphi$ 角度

![[图形学/misc/_attachments/1062px-Plane_with_ENU_embedded_axes.svg.png | 200]]


#### 欧拉角对应的旋转矩阵

extrinsic 约定的旋转轴都是世界坐标系的坐标轴，很容易可以写出旋转矩阵。

以 yaw-pitch-roll 形式为例，其对应的 extrinsic 顺序为 x-y-z，则对应的旋转矩阵为：

$$
R = R_z(\psi)\ R_y(\theta)\ R_x(\varphi)
$$


#### 万向节死锁

![[图形学/misc/_attachments/Gimbaleuler.svg.png | 200]]

上图的万向节可以对应 intrinsic 形式的 z-X-Z 顺序的欧拉角。

当转轴 z 和 Z 重合时，就称发生了死锁。

解除死锁的办法：只需要改变 X 的旋转角度即可，确保角度不是 $\pi/2$ 或 $-\pi/2$ 


>[!note] 参考 
> - [Euler angles | wikipedia](https://en.wikipedia.org/wiki/Euler_angles)
> - [[图形学/misc/_attachments/3D Transformations Cornell CS4620.pdf]]

