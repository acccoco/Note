
### 数值积分
对于一个积分$\int_0^1f(x)dx$ ，对应的数值积分可以写出如下形式：
$$I = \frac{1}{N}\sum_{i=1}^{n}f(x_i)$$

如果 $x_i = \frac{i}{N}$ ，那么这是「**黎曼积分**」
如果 $x_i \sim U(0,\ 1)$ ，那么这是「**蒙特卡洛积分**」
如果 $\{x_i\}$ 是一个低差异序列，那么这是「**拟-蒙特卡洛积分**」

> 黎曼积分的一般形式：$I = \frac{\int_{S}ds}{N} \sum_{i=1}^{N}f(x_i)$ 



### 蒙特卡洛积分
**蒙特卡洛积分方法**：

- 需要积分的函数 $g(x)$  定义域为 $[a,\ b]$ ；
- 选择定义在 $[a, \ b]$  上的随机变量 $X_k$ ，其概率密度函数为 $f_{X_k}(x_k)$ ；

则函数 $g(x)$  的积分可以通过一下方法近似得到：
$$\tilde{I} = \frac{1}{n}\sum_{k=1}^n
\frac{g(x_k)}{f_{X_k}(x_k)}$$

**无偏性**：
![[图形学/misc/_attachments/u4ff7229d_EC生1= EMs E HCXL).png | 365]]

这说明 $\tilde{I}$  是对函数积分的「无偏估计」

**蒙特卡洛方法的方差**：
![[图形学/misc/_attachments/uc0e05d3d_=市器（堂他 I).png | 401]]
从上面的表达式可以看出，为了将标准差降低到 $\frac{1}{2}$ ，需要让采样数变成原来的 $4$ 倍。

**「弱大数定理」的角度**：
而根据「弱大数定理」，随着 $n$  的增加，$\tilde{I}$  的分布会越来越集中于$E[\frac{g(x)}{f_X(x)}]$ ，也就是函数值的积分
![[图形学/misc/_attachments/ue4e2c4c1_Pasted Graphic.png | 248]]

**「中心极限定理」的角度**：
如下图所示：（根据「中心极限定理」，当 $n$  较大时，$\tilde{I}$  近似可以看成「正态分布」。
![[图形学/misc/_attachments/u408602d4_Pasted Graphic.png | 344]]


### 数值积分的简单实现
如果要计算积分：
$$\int_{\Omega(2\pi)} f(\omega) d\omega$$

那么实现的代码可以是：
![[图形学/misc/_attachments/ubfc51b8d_image.png | 583]]



