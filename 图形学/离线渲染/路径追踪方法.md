

## 路径追踪的示意图
![[图形学/离线渲染/_attachments/1667212801.0900831_image.png | 541]]

某个像素的颜色来源：
![[图形学/离线渲染/_attachments/1667212801.219867_image.png | 481]]


## 对光源采样的优化
对于直接光照，改变积分域（从半球空间变成光源表面。由于后面会用到 Monte Carlo 来计算积分，从光源表面采样，可以保证不浪费采样光线）
![[图形学/离线渲染/_attachments/1667212801.3749309_image.png | 553]]

使用蒙特卡洛计算光源采样，pdf应该取多少？应该取 $\frac{1}{所有光源表面积}$ ，无论光源表面是否被遮挡
因为直接光照的反射方程可以写成这样：
![[图形学/离线渲染/_attachments/1667212801.488068_image.png | 331]]


## 蒙特卡洛来计算积分
![[图形学/离线渲染/_attachments/1667212801.581527_image.png | 487]]

使用蒙特卡洛积分，这也是 path tracing 名称的来源

pdf的计算方法：
![[图形学/离线渲染/_attachments/1667212801.769873_image.png | 517]]


## 何时终止光线弹射：俄罗斯轮盘赌
![[图形学/离线渲染/_attachments/1667212801.892707_image.png | 516]]
可以计算出弹射次数的期望为：$E = \frac{RR}{(1 - RR)^2}$ ，当 $RR = 0.8$  时，期望弹射 20 次



## BRDF 的理解
BRDF 就是物体颜色的来源。考虑一束白光射在物体上，因为物体对不同色光的吸收/发射率不同，因此最终呈现出不同的颜色

![[图形学/离线渲染/_attachments/1667212802.023552_image.png | 519]]
