[toc]

#### `pid_t fork(void)`

- 创建子进程。
- 失败时：给父进程返回`-1`，并且会设置`errno`。
- 成功时：父进程返回`pid`；子进程返回`0`。
```c
void fork_test() {
	pid_t = pid;
  switch(pid = fork()) {
    case -1:
      printf("fail\n");
      break;
    case 0:
      printf("this is child\n");
      break;
    default:
      printf("this is parent, child is %d\n", pid);
      break;
  }
}
```

#### Zombie进程

- 通过`zombie`机制，父进程可以异步回收子进程。
- 子进程`exit()`后，部分资源回收（打开文件，内存分配）；部分信息保留（进程号，运行时间，退出状态），这些信息直到父进程调用`wait()/waitpid()`时才释放。
- 如果父进程在子进程结束之前结束了，那么将由`init`进程来接管这些子进程。
- Zombie进程的**危害**：占用进程号。

#### 孤儿进程

- 如果父进程在子进程之前退出，那么子进程就成了孤儿进程，由`init`进程收养。
- 孤儿进程**无害**。

#### 处理子进程的方法

- 直接等待子进程
- 或者处理：子进程状态变化信号`SIGCHID`。
```c
void sig_chld(int signo) {
	pid_t pid;
  int stat;
  pid = wait(&stat);	// 获取子进程状态与pid
  return;
}
signal(SIGCHLD, sig_chld);
```
