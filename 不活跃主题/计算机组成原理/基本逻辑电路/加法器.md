![[不活跃主题/计算机组成原理/基本逻辑电路/_attachments/1634040714129-fa6ddb2d-4753-42cd-884f-58e5c3918336.jpeg ]]


## 一位全加器
计算一位数加法。
根据加数和进位的逻辑关系，可以得到：

- $S_i = A_i \oplus B_i \oplus C_{i-1}$ 
- $C_i = A_iB_i + (A_i\oplus B_i)C_{i-1}$ 

一位全加器的逻辑符号：
![[不活跃主题/计算机组成原理/基本逻辑电路/_attachments/1633957363759-a4c8c721-92f5-424e-b1dc-979a7db8574d.png | 315]]


## 并行加法器
「并行加法器」用于一次计算 n 位数的加法。

注：「串行加法器」中只有一个全加器，执行比较缓慢


### 串行进位的并行加法器
「串行进位的加法器」的特点是：低位产生的进位逐级传递到高位，总的计算时间主要取决于「进位信号的传递时间」。

简单地将多个「一位全加器」串联起来：
![[不活跃主题/计算机组成原理/基本逻辑电路/_attachments/1633962436590-fa0fa86b-d5f3-4581-9248-cba5ed8d372c.png | 412]]


### 并行进位的并行加法器
特点是：各级的信号是同时形成的。


#### 先行进位电路 CLA
考虑进位的计算方法：$C_i = A_iB_i + (A_i\oplus B_i)C_{i-1}$ ，其中：

- 将 $G_i = A_i B_i $  记作进位产生函数
- 将 $P_i = A_i\oplus B_i$  记作进位传递函数

采用上述的记号，各级的进位可以写作：

- $C_1 = G_1 + P_1 C_0$ 
- $C_2 = G_2 + P_2 C_1 = G_2 + P_2 G_1 + P_2P_1C_0$ 
- $C_3 = G_3 + P_3 C_2 = G_3 + P_3 G_2 + P_3 P_2 G_1 + P_3 P_2 P_1 C_0$ 

对于每一位的加法，只需要获得低位的「进位产生函数」和「进位传递函数」，即可同时进行计算。

对应的电路叫做「先行进位电路」，如图是「4位先行进位电路」的示意图。（图中的 $d$  表示「进位产生函数」，$t$  表示「进位传递函数」）
![[不活跃主题/计算机组成原理/基本逻辑电路/_attachments/1633958501729-3d4eccf9-b0e9-428e-860a-e587dc462ee6.png | 453]]

CLA加法器：由 1 个「4位先行进位电路」，进位产生/传递电路和求和电路，可以构成一个「**4位CLA加法器**」：
![[不活跃主题/计算机组成原理/基本逻辑电路/_attachments/1633959071005-f0d63ea1-067a-4cc5-b851-8a5055b2393a.png | 210]]


#### 单级先行进位加法器
全部使用并行进位，会导致电路非常复杂。
可以考虑进行分组加法，**组内使用并行进位，组间使用串行进位**，如下图：
![[不活跃主题/计算机组成原理/基本逻辑电路/_attachments/1633959207830-640e5409-b467-4780-9e7c-f93380df7491.png | 534]]


#### 成组先行进位电路 BCLA
考虑第一小组的进位：$C_4 = G_4 + P_4 G_3 + P_4 P_3G_2 + P_4P_3P_2G_1 + P_4P_3P_2P_1C_0$ ，其中：

- ${G_1}^* = G_4 + P_4 G_3 + P_4 P_3G_2 + P_4P_3P_2G_1$ ，称为「组进位产生函数」
- ${P_1}^* = P_4P_3P_2P_1$ ，称为「组进位传递函数」

「BCLA电路」可以产生上述的输出值：（图中的 $T_8$  表示「组进位传递函数」，$D_8$  表示「组进位产生函数」）
![[不活跃主题/计算机组成原理/基本逻辑电路/_attachments/1633959944446-249bc530-4484-47aa-bf41-8c4e12ffe4ec.png | 396]]

由「BCLA电路」，进位产生/传递电路和求和电路可以构成「BCLA」加法器：
![[不活跃主题/计算机组成原理/基本逻辑电路/_attachments/1633960185108-e5cc3c23-ef9d-46a4-a95c-2f62deac356d.png | 161]]


#### 多级先行进位加法器
**组内并行进位，组间也是并行进位**，这需要用到 「BCLA加法器」和「CLA电路」：
![[不活跃主题/计算机组成原理/基本逻辑电路/_attachments/1633960516696-31db7674-7eff-450c-8384-8c20a7d2f6d4.png | 551]]


## 算数逻辑单元 ALU
算数逻辑单元可以执行多种计算：四则运算，逻辑运算等。

ALU 的逻辑结构如下：
其中 `ALUop` 表示需要执行何种操作。
![[不活跃主题/计算机组成原理/基本逻辑电路/_attachments/1633960867751-37bd9882-53bb-45e3-bf03-ed248c0be9a5.png | 250]]

如何选择执行各种功能：ALU内部**可能会把每种运算都执行一遍**，然后用一个多路选择器选择需要的结果。
以一个可以执行「与」「或」「一位数加法」的「一位ALU」为例：
![[不活跃主题/计算机组成原理/基本逻辑电路/_attachments/1633960761380-5b3c04c2-2dbc-4f9c-bda7-ef8e720c9af3.png | 253]]


### 加法器的标志
带标志的加法器如下图：（简单起见，加法器使用的是「串行进位的并行加法器」）
![[不活跃主题/计算机组成原理/基本逻辑电路/_attachments/1633961659935-df155e1f-24db-4794-90cb-42412430ceb5.png | 565]]

带标志的加法器可以提供额外的标志信息：

- 溢出标志 `OF` ：这一位只对**有符号数**有意义。数值最高位的进位和符号位的进位不同时，则溢出：$OF = C_n \oplus C_{n-1}$ 
- 符号位 `SF` ：这个位只对**有符号数**才有意义。直接取计算结果的最高位即可：$SF = F_{n-1}$ 
- 零标志位 `ZF` ：计算结果是否是 0


### 如何执行减法
如何执行补码减法运算：通过「取反加一」的操作可以得到一个数负数的补码。
可以通过一个「2选1多路选择器」来控制是否执行减法运算，并把「选择器」的值输入 $C_{in}$ ，作为「取反加一」中的「加一」。如下图所示：
![[不活跃主题/计算机组成原理/基本逻辑电路/_attachments/1633962060188-44d8bd79-0b49-4933-96df-66124096ffcf.png | 380]]

加法器中的「进位标志`CF`」：进位标志只有当执行**无符号数**运算时才有用

- 进行加法时， $CF = C_{out}$  表示溢出
- 进行减法时，$CF = \overline{C_{out}}$  表示借位
- 由于加法和减法可以通过 $Sub$  进行区分，因此：$CF = C_{out} \oplus Sub$ 





