
### 中心极限定理
首先给出几个随机变量：

- $X_i$ ：分布相同，期望为 $\mu$ ，方差为 $\sigma^2$ 
- $S_n = X_1 + \cdots + X_n$ ，期望为 $n\mu$ ，方差为 $n\sigma^2$  
- $M_n = \frac{S_n}{n}$ ，期望为 $\mu$ ，方差为 $\frac{\sigma^2}{n}$  。该随机变量依概率收敛到 $\mu$  
- $\frac{S_n}{\sqrt{n}}$ ，期望为 $\sqrt{n}\mu$ ，方差为 $\sigma^2$  

**中心极限定理**：
考虑这样的随机变量：
$$Z_n = \frac{S_n - E[S_n]}{\sigma_{S_n}} = \frac{S_n - n\mu}{\sqrt{n}\sigma}$$

可以看到，$Z_n$  是对 $S_n$  的标准化，期望和方差为：
$$E[Z_n] = 0,\quad var(Z_n) = 1$$

然后，$Z$  是正态分布的随机变量：$Z\sim N(0,\ 1)$ 。

中心极限定理是指，当 $n$  很大时，有：
$$P(Z_n \le c) \approx P(Z\le c)$$

也就是说：**多个同分布的随机变量之和经过标准化后，其分布接近正态分布**。
这样就可以用正态分布的 CDF 来对随机变量之和进行近似。

如下图所示，$X_i\sim U(-3,\ 4)$  是均匀分布的随机变量，多个 $X_i$  累加后得到的随机变量与正态分布非常近似了：
![[不活跃主题/概率论/概率论/_attachments/1644930321196-11096a34-edbf-413b-bf95-971b728fd45b.png | 459]]


### 中心极限定理与二项分布
在伯努利试验中，用 $X_i$  表示每次试验的结果，$X_i$  符合伯努利分布：
$$X_i = 
\left\{\begin{array}{rll}
1, & p \\
0, & 1 - p
\end{array}\right.$$

将多个 $X_i$  累加，可以得到二项分布的随机变量：
$$S_n = X_1 + \cdots + X_n$$

由于二项分布等价于一系列同分布，期望和方差有限的随机变量之和，因此可以用「正态分布」来近似「二项分布」。
「二项分布」的极限情况就是「正态分布」。


### 例子
在一项民意调查中，每个人可以投出支持和反对两种票，用 $X_i$  来表示投票情况。$X_i$  满足：
$$X_i = 
\left\{
\begin{array}{ll}
1, & f \\
0, & 1 - f
\end{array}
\right.$$

现在需要找出民意 $f$ ，通过采样的方式来近似得到。由弱大数定理可知，$M_n = \frac{X_1 + \cdots + X_n}{n}$  依概率收敛于 $E[X_i] = f$ 。
问需要多大的样本才能够保证精度在 $0.01$  内具有 $95\%$  的置信度，即：
$$P(|M_n - f| \ge 0.01) \le 0.05$$

分析：
用中心极限定理来处理，做如下的近似：
![[不活跃主题/概率论/概率论/_attachments/1645874624944-4ef30d0c-d1b4-421a-86e8-402346c84c9f.png | 214]]
因此，目标不等式就变成了：其中 $Z\sim N(0,\ 1)$  
$$P(|Z| \ge \frac{0.01 \sqrt{n}}{\sigma}) \le 0.05$$

查正态分布表，计算得到最小样数为 $9604$  
