:::warning
**什么是正定矩阵**：

- 从名字可知，「特征值」全是正数的矩阵就是正定矩阵
- 由于特征值全是实数，因此正定矩阵一定是「对称矩阵」

**正定矩阵有什么特征**：

- 所有的「主元」都是正数
- 所有的「子行列式」都是正数
- $x^T A x > 0$  在 $x \ne 0$  时恒成立

**为什么要研究正定矩阵**：

- 为了得到二次表达式的最小值。

**表达式 **$x^T A x$ ** 的图像是什么**：

- 正定矩阵的图像在「原点」处是「极小值」。整体图像是一个「碗形」
- 非正定矩阵的图像在「原点」处，沿某些方向是「极小值」，沿某些方向是「极大值」。整体图像是一个「鞍面」
- 半正定矩阵的图像在「原点处」。整体图像是一个「峡谷」

**主轴定理**：

- 截取正定矩阵的 $x^T A x$  的图像，可以得到一个「椭圆」。椭圆的主轴长度和「特征值」有关，主轴的方向和「特征向量」有关。

**正定矩阵和 **$x^T A x$ ** 之间的关系是什么**：

- 正定矩阵是 $x^T A x$  的二阶导数矩阵

对 $x^T A x$  进行配方，配方的系数可以从矩阵 $A$  的 $LU$  分解中得到。（对应高斯消元的分解）
:::


## 正定矩阵


### 一、矩阵主元性质

1. **矩阵主元的符号和特征值的符号一致。**
2. **矩阵主元的乘积等于行列式。**


##### 这里不进行证明，只是举例说明这些性质
> 对于矩阵** **$$A = \left[\begin{array}{ll}
5 & 2 \\
2 & 3
\end{array}\right]$$ 
> 进行行变换得到：$$\left[\begin{array}{cc}
5 & 2 \\
0 & 11 / 5
\end{array}\right]$$ ，因此其主元为 $5$  和 $\frac{11}{5}$ 。
> 行列式等于主元的乘积： $\det A = 11 = 5 \times \frac{11}{5}$ 
> 可以算出特征值为 $\lambda_1 = 4 + \sqrt{5},\ \lambda_2 = 4 - \sqrt{5}$ ，两个特征值都是正数，与主元的符号对应。



### 二、正定矩阵
**什么是正定矩阵**：**正定矩阵也是「对称矩阵」。**

**正定矩阵的判断条件（任意一条都可以）：**

1. **正定矩阵的特征值都是正数**
2. **正定矩阵的所有主元是正数**
3. **正定矩阵的所有「子行列式」也是正数**
4. $x^T A x > 0$  恒成立

> 由于「主元」的符号和「特征值」的符号对应，「特征值」都是正数，因此「主元」也都是正数。



##### 正定矩阵的「子行列式」是正数：
> 不证明，仅举例说明：
> ![[不活跃主题/线性代数/线性代数/_attachments/1667214568.715246_image.png | 135]]



## 正定矩阵的意义
用下面这个矩阵来研究正定矩阵：
$$\left[\begin{array}{ll}
2 & 4 \\
4 & {\color{red}*}
\end{array}\right]$$



### 一、半正定情形
$$\left[\begin{array}{ll}
2 & 4 \\
4 & {\color{red}8}
\end{array}\right]$$

根据正定矩阵的判断条件，这个矩阵的所有子行列式 $\ge 0$ ，将这种情形称为「**半正定**」。

- 矩阵的特征值为 $\lambda = 0,\ 10$ ；
- 特征向量为 $$\left[\begin{array}{c}
-2 \\
1
\end{array}\right]$$  和 $$\left[\begin{array}{c}
1/2 \\
1
\end{array}\right]$$ 
- 矩阵一定是一个奇异矩阵，因此主元只有一个 $pivot = 2$ 。

用 $x^T A x$  来检验这个矩阵：（这个表达式称为「**二次型**」）
$$x^T A x = 2 x_1{}^2 + 8 x_1 x_2 + 8 x_2{}^2$$

这个表达式是否满足：$x^T A x > 0$ ？

用图像来观察这个表达式：
![[不活跃主题/线性代数/线性代数/_attachments/1667214569.129434_image.png | 351]]

可以看到，直线上的点（特征向量 $[-2 \; 1]^T$ ），函数值为 $0$ ，因此 $x^T A x > 0$  并不是恒成立的。


### 二、非正定情形
$$\left[\begin{array}{ll}
2 & 4 \\
4 & {\color{red}2}
\end{array}\right]$$

- 其特征值为 $\lambda_1 = -2,\ \lambda_2 = 6$ 
- 特征向量为：$$\left[\begin{array}{c}
-1 \\
1
\end{array}\right]$$  和 $$\left[\begin{array}{c}
1 \\
1
\end{array}\right]$$ 
- $x^T A x = 2 x_1{}^2 + 8 x_1 x_2 + 2 x_2 {}^2$ 

对应的图像为：
![[不活跃主题/线性代数/线性代数/_attachments/1667214569.456266_image.png | 338]]

这个图像是一个马鞍面。原点是一个「**鞍点**」—— 同时是一个方向的极大值和另一个方向的极小值。


### 三、正定情形
$$\left[\begin{array}{ll}
2 & 4 \\
4 & {\color{red}{10}}
\end{array}\right]$$

- 特征值为 $\lambda_1 = 6 + 4\sqrt{2}, \ 
\lambda_2 = 6 - 4\sqrt{2}$ 

- 特征向量为：$$\left[\begin{array}{c}
\sqrt{2}-1 \\
1
\end{array}\right]$$  和 $$\left[\begin{array}{c}
\sqrt{2} + 1 \\
-1
\end{array}\right]$$ 

- $x^T A x = 2 x_1{}^2 + 8 x_1 x_2 + 10 x_2 {}^2$ 

对应的图像为：
![[不活跃主题/线性代数/线性代数/_attachments/1667214569.864536_image.png | 278]]

虽然不太明显，但这个图形是一个「**碗形**」，原点处是「**极小值点**」，原点出沿任方向的函数值都是**增大**的。

实际上，可以对「二次型」表达式进行「配方」，证明函数值始终大于 $0
$ ：
$$x^T A x = 2 (x_1 + 2 x_2 ) ^2 + 2 x_2{}^2$$

沿着 $z = a$  平面截取上述曲面，可以得到一个「**椭圆**」：
$$2 x_1{}^2 + 8 x_1 x_2 + 10 x_2 {}^2 = a$$

其图像为：
![[不活跃主题/线性代数/线性代数/_attachments/1667214570.377867_image.png | 224]]

如果用「高斯消元法」来分解矩阵 $A$ ，可以得到：
$$A = LU = 
\left[\begin{array}{ll}
1 & 0 \\
2 & 1
\end{array}\right]

\left[\begin{array}{ll}
2 & 4 \\
0 & 2
\end{array}\right]$$

现在看矩阵分解和「二次型」配方之间的联系：
![[不活跃主题/线性代数/线性代数/_attachments/1667214570.656897_image.png | 288]]

- 主元是配方后平方项的系数；
- $L$  矩阵的列对应平方项内的系数；

:::info
主元全是正数，意味着 $x^T A x$  可以配方为多个平方项的和。
:::

矩阵 $A$  与 $x^T A x$  的二阶导数直接的关系：
$$A = \frac{1}{2}
\left[\begin{array}{cc}
f_{x_1 x_1} & f_{x_1 x_2} \\
f_{x_1 x_2} & f_{x_2 x_2}
\end{array}\right]$$

:::info
最高次数为 $2$  次的多元函数 $f(x_1, x_2, \cdots, f_n)$  有极小值，等价于：
二阶导数矩阵是**正定**的。
:::


## 三阶正定矩阵
考虑以下的矩阵：
$$A=\left[\begin{array}{ccc}
2 & -1 & 0 \\
-1 & 2 & -1 \\
0 & -1 & 2
\end{array}\right]$$

这个矩阵：

- 子行列式是：$\det = 2,\ 3,\ 4 $ 
- 主元是：$pivot = 2,\ \frac{3}{2}, \ \frac{4}{3}$ 
- 特征值是：$\lambda = 2 - \sqrt{2}, \ 2,\ 2 + \sqrt{2}$ 

矩阵对应的二次型是：
$$x^T A x = 2 x_1 {}^2 + 2 x_2 {}^2 + 2 x_3 {}^2 
- 2 x_1 x_2 - 2 x_2 x_3$$

如果用一个超平面去切割这个图形，可以得到一个椭球：
$$2 x_1 {}^2 + 2 x_2 {}^2 + 2 x_3 {}^2 
- 2 x_1 x_2 - 2 x_2 x_3 = a$$

这个椭球具有什么特征：

- 三个「**主轴的方向**」由「**特征向量**」决定
- 主轴的长度由「**特征值**」决定

「正定矩阵」是「对称矩阵」，因此可以进行如下分解：
$$A = Q \Lambda Q^T$$

由于椭圆的几何特征可以直接从上述矩阵中找到，因此上述分解又叫做「**主轴定理**」。
 

## 常用的推论


##### 推论 1：矩阵 $A^TA$  的正定条件
矩阵 $A^T A$  是否是正定矩阵？可以通过 $x^TA x $  来判断：
$$\begin{aligned}
x^T\left(A^T A\right) x &=A x)^T(A x) \\
&=|A x|^{2}
\end{aligned}$$

由上述表达式可知，只要当 $x \ne 0$  时，向量 $Ax$  的长度不为零，那么 $A^T A$  就是正定矩阵。
这等价于：矩阵 $A$  的零空间中只有 $0$  向量，也就是：
$m \ge n = rank \ A$  


##### 推论 2：正定矩阵的逆矩阵
正定矩阵的逆矩阵是否是正定的吗？

可以从特征值的角度去考虑：
$$\begin{aligned}
A x &=\lambda x \\
A^{-1} A x &=\lambda A^{-1} x \\
A^{-1} x &=\frac{1}{\lambda} x
\end{aligned}$$

由上述关系式可知：
:::info
逆矩阵的特征值与原矩阵的特征值是倒数关系；
你矩阵和原矩阵的特征向量相同。
:::

因此，正定矩阵的逆矩阵也是正定的。


##### 推论 3：正定矩阵的和是否是正定的
如果 $A, \ B$  都是正定矩阵，那么他们的和是否是正定的？
$$\left.\begin{array}{l}
x^T A x>0 \\
x^T B x>0
\end{array}\right\} 
\quad x^T(A+B) x>0$$

是正定的。


## 正定矩阵与最小二乘法
最小二乘法可以对无解方程 $Ax = b$  进行求解。
可以得到近似解 $\hat{x} = (A^T A)^{-1} A^T b$  
得到近似解的前提条件是矩阵 $A^T A$  可逆。如果 $A^T A$  是「正定矩阵」，那么 $A^T A $  一定可逆，最小二乘法就有解。


