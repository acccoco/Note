> 什么是左逆和右逆：
> - 左逆就是矩阵左乘另一个矩阵可以得到单位矩阵。
> - 矩阵需要满秩才能有「左逆」或者「右逆」。
> 
 
> 什么是伪逆：
> - 矩阵乘以伪逆后，可以将向量投影到矩阵的「行空间」或者「列空间」。这就是伪逆的作用。
> - 「最小二乘法」需要将向量投影到「列空间」，伪逆正好可以用在这里。



### 左右逆

#### 一、左逆
如果矩阵 $A_{m\times n}$  的秩是 $n$ ，那么矩阵的**列向量**是线性无关的。

方程 $Ax=b$  可能有 0 个或 1 个解。（因为 $b\in R^m$ ，而**列空间**并不等于 $R^m$  ）

矩阵的四个基本子空间如下图所示：
![[不活跃主题/线性代数/线性代数/_attachments/1667214587.615227_image-20211220162431355.png | 300]]


矩阵 $(A^TA)_{n\times n}$ 是可逆的，由于以下的等式关系：
$$
{\color{red}(A^TA)^{-1}A^T} \ A = I
$$

因此称 $(A^TA)^{-1}A^T$ 是矩阵 $A$  的「**左逆**」。

如果矩阵 $A$  右乘「左逆」，可以得到：
$$
A (A^TA)^{-1}A^T
$$

前面已经推导过了，这个矩阵就是「投影矩阵」，可以将向量投影到矩阵 $A$  的「列空间」中。


#### 二、右逆
如果矩阵 $A_{m\times n}$  的秩是 $m$ ，那么矩阵的**行向量**是线性无关的。

方程 $Ax=b$  的解的情况为：有 1 个或无数个解。（因为**行空间**就等于 $R^m$ ）

矩阵四个子空间的情况是：
![[不活跃主题/线性代数/线性代数/_attachments/1667214588.022241_image-20211220163541196.png | 312]]

矩阵 $(AA^T)_{m\times m}$ 是可逆的，由于以下等式关系的存在：
$$
A \ {\color{red}A^T (A A^T)^{-1}} = I
$$

因此称 $A^T(AA^T)^{-1}$ 是矩阵 $A$  的「**右逆**」。

如果矩阵 $A$  左乘「右逆」，可以得到：
$$
A^T(AA^T)^{-1} A
$$

这个矩阵是 $A^T$  的「**投影矩阵**」，可以将向量投影到 $A^T$  的「列空间」，也就是 $A$  的「行空间」。


### 伪逆

#### 一、矩阵行列空间之间的关系
如果矩阵 $A_{m\times n}$  并不满秩，即：
$$
rank(A) < n,\quad
rank(A) < m
$$

这种情况下，就无法得到其「左逆」或「右逆」。

先来看一下矩阵的四个基本子空间的情况：
![[不活跃主题/线性代数/线性代数/_attachments/1667214588.389655_image-20211220165141944.png | 403]]

很容易知道，「行空间」中的向量和「列空间」中的向量是「一一对应」的。

> 行空间中的向量 $x, y$  分别对应列空间中的向量 $Ax, Ay$ 。
>  
> 如果 $x\ne y$ ，那么其对应的向量也不想等 $Ax \ne Ay$ 。（可以从这个关系式出发 $A(x-y)=0$，用归谬法证明）
>  
> 同理，列空间中不同的向量在行空间中对应的向量也是不同的。
>  
> 因此，行空间和列空间中的乡里那个是「**一一对应**」的。



#### 二、伪逆
直接给出伪逆的定义。

矩阵的 SVD 分解是 $A = U\Sigma V^T$  ，伪逆为：
$$A^+ = V\Sigma^+ U^T
$$

其中 $\Sigma^+$  如下所示：
![[不活跃主题/线性代数/线性代数/_attachments/1667214588.633766_image-20211220170329497.png | 414]]

$\Sigma$  的伪逆的作用：

- $\Sigma \Sigma^+$  可以将向量投影到 $\Sigma$  的「**列空间**」
- $\Sigma^+ \Sigma$  可以将向量投影到 $\Sigma$  的「**行空间**」

$$\Sigma \Sigma^+ =
\begin{bmatrix}
	I_{r \times r} & 0 \\
	0 & 0
\end{bmatrix}_{m\times m}
\quad
\Sigma^+ \Sigma =
\begin{bmatrix}
	I_{r \times r} & 0 \\
	0 & 0
\end{bmatrix}_{n\times n}
$$


#### 三、伪逆和行列空间的联系

矩阵 $A$  的伪逆，$AA^+$  可以将向量投影到矩阵 $A$  的「**列空间**」。
$$AA^+x = U \Sigma \Sigma^+ U^Tx
$$

其中，$x$  是 $R^m$  中的一个向量。

用 $AA^+$  左乘 $x$   相当于先将 $x$  分解为与「列空间」有关的部分和与「左零空间」有关的部分，然后再去掉和「左零空间」有关的部分。

> 对于 $R^m$  中的向量 $x$ ，$U^T x$  相当于对其进行「基变换」。
>  
> 在 SVD 分解中已经知道，矩阵 $U$  由 $A$  的「列空间」和「左零空间」的「基向量」组成。
>  
> $x$  实际上是向量使用标准基时的系数，如果将「标准基」变为 $U$  矩阵对应的基：
> $Ix = U c
$ 
>  
> 因此，$U^T x$  就是向量 $x$  使用 $U$  对应的基表示时的**系数**。这些系数中前 $r$  对应「列空间」的基向量，后 $m-r$  个对应「左零空间」的基向量。
>  
> $\Sigma \Sigma^+$  乘以一个向量时可以让向量的后 $m-r$  个分量变为零，相当于去掉了向量 $x$  中和「左零空间」有关的部分，留下了和「列空间」有关的部分。
>  
> 最后再用剩下的系数左乘矩阵 $U$ ，相当于又变回了「标准基」的形式。


矩阵的四个基本子空间通过其伪逆联系在了一起：
![[不活跃主题/线性代数/线性代数/_attachments/1667214589.045533_image-20211220173030322.png | 299]]

> 为什么 $A^+Ax=x$ ：
>  
> 乘以 $A^+A$  相当于先将 $x$  分解为「行空间」有关的部分和「零空间」有关的部分，在去掉「零空间」有关的部分。由于 $x$  位于 $A$  的「行空间」中，因此进行这种乘法后结果仍然不变。

