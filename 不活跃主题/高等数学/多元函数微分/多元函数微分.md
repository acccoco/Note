
## 偏导数

### * 偏导数的定义
函数 $f(x,y)$  在点 $(x_0, y_0)$  处关于 $x$  的「偏导数」为：
$$\left.\frac{\partial f}{\partial x}\right|_{\begin{matrix}x=x_0\\y=y_0\end{matrix}}
= \lim_{\Delta x \to 0} \frac{f(x_0 + \Delta x, y_0) - f(x_0, y_0)}{\Delta x}$$

函数 $f(x,y)$  关于自变量 $x$  的「偏导函数」为：
$$\frac{\partial f}{\partial x} = f_x(x,y) = \lim_{\Delta x \to 0}\frac{f(x + \Delta x, y) - f(x,y)}{\Delta x}$$

> 注：偏导数 $\frac{\partial f}{\partial x}$  是一个整体记号，不能看作分子和分母的商。



### * 偏导数的几何意义
![[不活跃主题/高等数学/多元函数微分/_attachments/1636791671949-54648215-ee44-4771-af22-07f1ea43a270.png | 227]]
作 $y = y_0$  平面截取二元函数 $z = f(x,y)$  定义的曲面，得到曲线 $z = f(x, y_0)$ ，该曲线在点 $x_0$  处的导数，即为曲面在点 $(x_0, y_0)$  处关于 $x$  的偏导数：
$$\left.\frac{d}{dx}f(x,y_0)\right|_{x=x_0} = 
\left.\frac{\partial f}{\partial x}\right|_{\begin{matrix}x=x_0\\y=y_0\end{matrix}}$$
偏导数表示沿某个方向进行趋近。


### * 高阶偏导数
表示方法为：
$$\frac{\partial}{\partial y}\left( \frac{\partial z}{\partial x} \right)
= \frac{\partial ^2 z}{\partial x \partial y} = f_{xy}(x,y)$$

二阶混合偏导数存在以下关系：
$$f_{xy}(x,y) = f_{yx}(x,y)$$


## 全微分

### * 偏微分
**偏增量**中的线性主部叫做**偏微分**（等式坐标是偏增量，右边是偏微分）：
$$f(x+\Delta x, y) - f(x,y) \approx f_x(x,y)\Delta x$$

二元函数的「**全增量**」可以表示为：
$$\Delta z = f(x + \Delta x, y + \Delta y) - f(x,y)$$


### * 全微分
用自变量增量 $\Delta x,\, \Delta y$  的线性组合来替代全增量的思想即为**微分**思想。
如果函数的「全增量」可以表示为：
$$\Delta z = A\Delta x + B \Delta y + o(\sqrt{(\Delta x)^2 + (\Delta y)^2})$$

那么函数在点 $(x,y)$  处可微分，函数的「**全微分**」为：
$$dz = A\Delta x + B\Delta y$$

如果函数可微分，那么其全微分即为：
$$dz = \frac{\partial z}{\partial x}\Delta x + \frac{\partial z}{\partial y}\Delta y$$
> 只要分别令 $\Delta x,\, \Delta y$  为零，就可以求出上述表达式


**二元函数什么时候可以微分**？

- 必要条件：偏导数存在
- 充分条件：函数连续


## 多元复合函数的求导方法
**情形1**：
函数 $u = \varphi(t)$  及 $v = \psi(t)$  在点 $t$  可导，函数 $z = f(u,v)$  在点 $(u,v)$  处有连续的偏导数，那么复合函数 $z = f[\varphi(t), \psi(t)]$  在点 $t$  处的导数为：
![[不活跃主题/高等数学/多元函数微分/_attachments/1636793839701-38f90c35-61ab-47a9-b3ad-f60e22bd71e7.png | 109]]
$$\frac{dz}{dt} = \frac{\partial z}{\partial u}\frac{du}{dt} + \frac{\partial z}{\partial v}\frac{dv}{dt}$$

**情形2**：
函数 $u = \varphi(x,y)$  及 $v = \psi(x,y)$  在点 $(x,y)$  处有偏导数，函数 $z = f(u,v)$  在点 $(u,v)$  处有连续偏导数，那么复合函数 $f[\varphi(x,y), \psi(x,y)]$  在点 $(x,y)$  处的偏导数为：
![[不活跃主题/高等数学/多元函数微分/_attachments/1636794147003-d87a6962-6b0f-4528-9a30-291a0f80322d.png | 135]]
$$\frac{\partial z}{\partial x} = 
\frac{\partial z}{\partial u}\frac{\partial u}{\partial x} + 
\frac{\partial z}{\partial v}\frac{\partial v}{\partial x} $$


## 隐函数的导数
**一元函数**：
如果一元函数 $y=f(x)$  由方程 $F(x,y) = 0$  确定，那么有：
$$F[x, f(x)] = 0$$

等式两边对 $x$  求导，可以得到：
$$\frac{\partial F}{\partial x} + \frac{\partial F}{\partial y}\frac{dy}{dx} = 0$$

满足一定条件可以变形得到以下等式，「隐函数的求导公式」：
$$\frac{dy}{dx} = -\frac{F_x}{F_y}$$

**二元函数**：
如果二元函数 $z = f(x,y)$  由方程 $F(x,y,z)=0$  确定，那么有：
$$F[x, y, f(x,y)] = 0$$

两边对 $x$  求导，得到：
$$\frac{\partial F}{\partial x} + \frac{\partial F}{\partial z}\frac{\partial z}{\partial x} = 0$$

由此可以得到隐函数的求导公式：
$$\frac{\partial z}{\partial x} = - \frac{F_x}{F_z}$$

**方程组情形**：
如果函数 $$\left\{
\begin{matrix}
u = u(x,y) \\
v = v(x,y)
\end{matrix}
\right.$$  由方程组确定 $$\left\{
\begin{matrix}
F(x,y,u,v) = 0 \\
G(x,y,u,v) = 0
\end{matrix}
\right.$$ ，那么有：

$$\left\{
\begin{matrix}
F[x,y,u(x,y),v(x,y)] = 0 \\
G[x,y,u(x,y),v(x,y)] = 0
\end{matrix}
\right.$$

两边同时对 $x$  求导，可以得到：
$$\left\{
\begin{matrix}
F_x + F_u\frac{\partial u}{\partial x} + F_v\frac{\partial v}{\partial x} = 0 \\
G_x + G_u\frac{\partial u}{\partial x} + G_v\frac{\partial v}{\partial x} = 0
\end{matrix}
\right.$$

从而可以解出 $\frac{\partial u}{\partial x}$  和 $\frac{\partial v}{\partial x}$ ：
$\frac{\partial u}{\partial x} = -\frac{1}{J} \frac{\partial (F, G)}{\partial (x,v)}$ ，$\frac{\partial v}{\partial x} = -\frac{1}{J} \frac{\partial (F, G)}{\partial (u,x)}$ 

> 雅各比行列式为：
> $$J = \frac{\partial (F,G)}{\partial (u,v)} = 
\begin{vmatrix}
\frac{\partial F}{\partial u} & \frac{\partial F}{\partial v} \\
\frac{\partial G}{\partial u} & \frac{\partial G}{\partial v}
\end{vmatrix}$$ 



## 条件极值
已知一个多元函数 $z = f(x,y)$ ，函数自变量满足的方程 $\varphi (x,y) = 0$ ，求该函数的极值。
![[不活跃主题/高等数学/多元函数微分/_attachments/1636857340182-91b56499-e35f-4f9d-aa31-7cb464310aa4.png | 101]]


### * 朴素的方法
可以将方程带入函数，求函数的极值。
> 【例如】
> 函数 $z = x^2 + y^2$ ，约束方程为 $y = 4x$ ；
> 将方程带入函数后，可以得到 $z = 17 x^2$ ，很容易求得极值。



### * 拉格朗日乘数法
**拉格朗日乘数法的推导**：
由约束方程 $\varphi(x,y)=0$  确定的函数可以表示为 $y = \psi(x)$ ，将其带入函数 $z = f(x,y)$  中可以得到：
$$z = f[x, \psi(x)]$$

上式是 $z$  关于 $x$  的一元函数，取得极值就意味着：
$$\left. \frac{dz}{dx} \right|_{x=x_0}  =f_x(x_0, y_0) + f_y(x_0, y_0) \left. \frac{dy}{dx} \right |_{x=x_0} = 0$$

通过约束方程可以得到（隐函数求导）：
$$\left. \frac{dy}{dx} \right |_{x=x_0} = -\frac{\varphi_x(x_0, y_0)}{\varphi_y(x_0, y_0)}$$

最终得到取得极值需要满足的方程：
$$\left\{
\begin{array}{lll}
f_x(x_0, y_0) - f_y(x_0, y_0) \frac{\varphi_x(x_0, y_0)}{\varphi_y(x_0, y_0)} = 0 \\
\varphi(x, y) = 0
\end{array}
\right.$$

**拉格朗日乘数法**：
根据函数 $z = f(x,y)$  和约束方程 $\varphi(x,y) = 0$  作出拉格朗日函数：
$$L(x,y) = f(x,y) + \lambda\varphi(x,y)$$

然后写出以下方程组：
$$\left\{
\begin{array}{lll}
L_x(x,y) = 0 \\
L_y(x,y) = 0 \\
\varphi(x,y) = 0
\end{array}
\right.$$

解方程组可以得到 $x,\, y,\, \lambda$ ，这就是可能的极值。

> $\lambda$  的意义是什么：
> $\lambda$  只是一个参数。
> 假设极值为 $(x_0, y_0)$ ，那么解出的 $\lambda$  符合 $\lambda = \frac{f_y(x_0, y_0)}{\varphi_y(x_0, y_0)}$ 


