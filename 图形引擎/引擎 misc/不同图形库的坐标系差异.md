

> [!note] 
> 现代图形库使用的都是可编程渲染管线，并不倾向于某种「手性」的坐标系。只要最终提交了合适的裁剪空间坐标即可。
> 
> 你的 shader 决定了 application 使用什么坐标系

坐标系参考：

![[图形引擎/引擎 misc/_attachments/Pasted image 20230405235352.png | 400]]

### NDC

假设「view space」的坐标系是**以摄像机为原点，摄像机朝向为**$-z$**的右手系**：

![[图形引擎/引擎 misc/_attachments/Pasted_Graphic.png | 200]]

#### OpenGL

OpenGL 的 NDC 是左手系，NDC 与 frustum 中各点的对应关系为：

![[图形引擎/引擎 misc/_attachments/Pasted_Graphic_1.png | 400]]

这种变换矩阵对应 `glm::perspectiveRH_NO()`（clip 的 near 和 far 对应 NDC 的 -1 和 +1）

（OpenGL 之后会将 NDC 的 z 值线性映射为深度值 $[0,\ 1]$ ）


#### vulkan

vulkan 的 NDC 是右手系，NDC 与 frustum 的对应关系为：

![[图形引擎/引擎 misc/_attachments/VaLLan_NDC_Craht_hard〕.png | 400]]


这种变换矩阵在 `glm` 中没有直接对应，可以基于 `glm::perspectiveRH_ZO()`（clip 的 near 和 far 对应 NDC 的 0 和 +1），并且进行 `M[1][1] *= -1` 修改得到。


### framebuffer space

「window space」，也就是「framebuffer space」。该空间的 $x,\ y$ 坐标和屏幕的像素对应，$z$ 坐标用于深度测试。

OpenGL 和 vulkan 的「framebuffer space」示意图为：

![[图形引擎/引擎 misc/_attachments/Pasted_Graphic_4.png | 320]]


OpenGL 的深度范围是 $[0,\ 1]$，vulkan 的深度范围可以手动指定，一般也设定为 $[0,\ 1]$ 。

