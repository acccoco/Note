
## AO

![[_attachments/Pasted image 20221225165834.png|500]]

AO 的实现：


### AO 贴图

这是基本方法，将 AO 烘焙到贴图中。

![[_attachments/Pasted image 20221225170037.png|500]]

很适合静态物体。


### SSAO

对于动态物体，没法预计算，只能实时计算。

![[_attachments/Pasted image 20221225170234.png|500]]

这个方法有问题，但是 Screen Space 的思路很重要。

对该方法的改善，就有 SSAO+。

![[_attachments/Pasted image 20221225170752.png|500]]

### 现在的方法

HBAO：使用 Ray March 的方法，来得到最大的未被遮挡的 $\theta$ 角度，以该角度作为 AO。缺点是，没有考虑不同 $\theta$ 角度的入射光线的贡献度差异。

GTAO：是目前使用的方法。基于 HBAO。GTAO 可以根据 AO 的遮挡程度，通过一个多项式，推算出 multi bounce 带颜色的值。（可以将 AO 与微表面模型的粗糙度类比来理解）

RTAO：暴力的 2spp 解决。且时间积累。


## Fog

基本方法：depth fog。

颜色根据距离衰减。

![[_attachments/Pasted image 20221225172358.png|500]]

---

Height Fog

进行了一系列的假设，可以直接得到解析解。

![[_attachments/Pasted image 20221225172700.png|500]]

---

体素 Fog

现代方法。

![[_attachments/Pasted image 20221225173131.png|500]]


## 抗锯齿

走样的分类：

![[_attachments/Pasted image 20221225173256.png|500]]


常见 AA 方法：

- SSAA：最简单暴力
- MSAA：仅边缘会进行多次采样，硬件支持。framebuffer 尺寸是多倍的，计算会少一些。但是现代的三角形数量非常多，MSAA 会退化为 SSAA。
- FXAA：（主流）。在亮度空间（Luminance）识别图像边缘。识别线条的方向（水平，垂直），根据方向和距离参考周边点的颜色。

![[_attachments/Pasted image 20221226155348.png|500]]

- TAA：（主流）。利用之前帧的数据。


## 后处理

常见的处理：物理真实的需要，以及风格化的需要

![[_attachments/Pasted image 20221226155945.png|500]]


Bloom ：提取高亮部分，通过高斯进行 blur。blur 时，可以先对图像进行降采样，再 blur，最后再升采样。这样可以获得较大的 blur 范围。

![[_attachments/Pasted image 20221226160633.png|500]]


Tone Mapping：使用曲线即可。Filmic 曲线，。。

Color Grading：就是后期调色。使用 LUT 来做。使用 3D Texture 来做，精度可以低一点（`16*16*16`），插值即可。


## 渲染管线

最基本的管线：Forward

![[_attachments/Pasted image 20221226171640.png|500]]

需要注意的点：先绘制不透明物体，最后绘制透明物体。

---

应对复杂光源的管线：Deferred

![[_attachments/Pasted image 20221226172052.png|500]]

---

Tile-based Rendering

移动端使用的管线。

也会用到 light cull。


---

Visibility Buffer：

不存储材质信息，而是存储 primitive ID，中心坐标等几何信息。

因为现代游戏场景的几何十分复杂。

![[_attachments/Pasted image 20221226172920.png|500]]
















