

# 渲染专题

### **渲染流程**

首先可以参考 OpenGL wiki 上的流程，每个流程要能够向别人讲述


```cardlink
url: https://www.khronos.org/opengl/wiki/Rendering_Pipeline_Overview
title: "Rendering Pipeline Overview - OpenGL Wiki"
host: www.khronos.org
```


这篇文档的图可以参考下：


```cardlink
url: https://learnopengl.com/Guest-Articles/2021/Tessellation/Tessellation
title: "LearnOpenGL - Tessellation"
description: "Learn OpenGL . com provides good and clear modern 3.3+ OpenGL tutorials with clear examples. A great resource to learn modern OpenGL aimed at beginners."
host: learnopengl.com
```


### **抗锯齿**

整理笔记的时候用得上。


```cardlink
url: https://zhuanlan.zhihu.com/p/415087003
title: "主流抗锯齿方案详解（一）MSAA"
description: "示例代码一、锯齿产生的原因我们都知道，显示器屏幕是由一个一个的像素组成的，所以渲染的过程需要将屏幕中的像素进行填充。 图形渲染的流程，就是一个一个的三角形，通过顶点着色器-&gt;光栅化-&gt;像素着色器这…"
host: zhuanlan.zhihu.com
```


### **渲染路径**

现在大致有 forword，deferred，forward+

要解决的问题：

- 各种的适用情形是什么？
- 各个渲染路径具体流程如何？

几种都介绍了：


```cardlink
url: https://www.cnblogs.com/KillerAery/p/15962110.html
title: "渲染路径（Rendering Path）：Forward、Deferred、Light-PrePass、Tiled、Clustered - KillerAery - 博客园"
description: "Forward Rendering（前向渲染） Forward Rendering/Forward Shading（前向渲染/前向着色）：传统的光栅化渲染流程中，场景中每个三角形都会被光栅化成若干个片"
host: www.cnblogs.com
```


forward+ 的论文：

[forward plus](https://takahiroharada.files.wordpress.com/2015/04/forward_plus.pdf)

几种流程详细比较：


```cardlink
url: https://www.3dgep.com/forward-plus/
title: "Forward+ Rendering"
description: "Comparing Forward, Deferred, and Forward+ rendering algorithms using DirectX 11."
host: www.3dgep.com
favicon: https://3dgep.com/wp-content/uploads/2014/03/favicon.png
image: https://www.3dgep.com/wp-content/uploads/2015/08/ForwardvDeferred-FeaturedImage.jpg
```


论坛讨论优缺点：


```cardlink
url: https://www.gamedev.net/forums/topic/666577-forward-vs-deferred-rendering/
title: "Forward+ vs Deferred rendering"
description: "Hi,&nbsp;As an independent study for college I am implementing a deferred renderer into the game engine I have been developing. I've been reading a lot about the details of this, but something that caught my eye is \"forward+\" rendering. It would seem to me that with the rise of physically based ma"
host: www.gamedev.net
favicon: /static/media/logo/icons/icon-512x512.png
```


Unity 给出的介绍：

- 在使用（多通道）[前向渲染路径](https://docs.unity3d.com/Manual/RenderTech-ForwardRendering.html)时，场景中的所有对象都是按顺序渲染，根据影响每个对象的光源数量，可能在多个通道中渲染，因此当对象被多个光源照亮时，渲染成本会急剧增加。这种类型的渲染器通常提供各种各样的着色器，并且可以很轻松地处理透明度。
- 在使用[延迟渲染路径](https://docs.unity3d.com/Manual/RenderTech-DeferredShading.html)时，所有（不透明）几何体首先渲染到缓冲区中，在其中存储有关材质的信息（颜色、镜面反射、光滑度等等）。在后一种通道（也就是“延迟”）中，每个像素按顺序着色：渲染时间将主要取决于影响每个像素的光源数量。对于透明对象以及某些包含复杂着色器的对象，仍然需要额外的前向渲染通道。当处理包含许多动态光源的场景时（例如具有人工光照的内部空间，或室外与室内光照相结合的项目），通常建议使用延迟渲染。

### Early Z

early z 是一个硬件功能，在光栅化之后可以获得一个 fragment 的 depth 了，此时的 depth test 就是 early z


```cardlink
url: https://zhuanlan.zhihu.com/p/53092784
title: "深入剖析GPU Early Z优化"
description: "最近在公司群里同事发了一个UE4关于Mask材质的优化，比如在场景中有大面积的草和树的时候，可以在很大程度上提高效率。这其中的原理就是利用了GPU的特性Early Z，但是它的做法跟我最开始的理解有些出入，因为Early…"
host: zhuanlan.zhihu.com
image: https://picd.zhimg.com/v2-ead01785099065d6bc0082a7995a5b2f_720w.jpg?source=172ae18b
```


early z 有何局限性？比如：半透明物体

early z 是否和 deferred 有冲突？

**半透明：**


```cardlink
url: https://www.zhihu.com/question/382932468/answer/1111595945
title: "OpenGL绘制半透明物体最简单的办法是什么？ - 知乎"
description: "你以为图形程序员这么好当的啊。。。上古时期有一个叫做画家算法[1]的东西，本质上很简单：从远向近地绘…"
host: www.zhihu.com
```



```cardlink
url: https://zhuanlan.zhihu.com/p/263566318?utm_medium=social&utm_oi=551847284401283072&utm_psn=1544263331774676992&utm_source=ZHShareTargetIDMore
title: "图形学|shader|用一篇文章理解半透明渲染、透明度测试和混合、提前深度测试并彻底理清渲染顺序。"
description: "遇到透明渲染时总有些概念没理清楚，今天来理理（由于本人未开发过渲染管线，无法实际验证，因此以下内容基于个人理解，不保证完全正确，有问题还请直接评论：()）。 文章目录场景中只有不透明物体的渲染场景中存…"
host: zhuanlan.zhihu.com
image: https://pic1.zhimg.com/v2-76bf9220875071be34abf52b1ab13b62_720w.jpg?source=172ae18b
```



```cardlink
url: https://www.zhihu.com/question/344729967/answer/815844314?utm_medium=social&utm_oi=551847284401283072&utm_psn=1545371946589859840&utm_source=ZHShareTargetIDMore
title: "不透明物体渲染时从前向后排序的意义何在？ - 知乎"
description: "前排反对 @vczh 轮子哥的回答，正因为有后处理特效需求，才会需要Geometry Pass输出GBuffer，每多一个GBu…"
host: www.zhihu.com
```



```cardlink
url: https://www.opengl-tutorial.org/intermediate-tutorials/tutorial-10-transparency/
title: "Tutorial 10 : Transparency"
description: "Free tutorials for modern Opengl (3.3 and later) in C/C++"
host: www.opengl-tutorial.org
```



```cardlink
url: https://learnopengl.com/Guest-Articles/2020/OIT/Weighted-Blended
title: "LearnOpenGL - Weighted Blended"
description: "Learn OpenGL . com provides good and clear modern 3.3+ OpenGL tutorials with clear examples. A great resource to learn modern OpenGL aimed at beginners."
host: learnopengl.com
```


### **如何渲染一杯水/水晶**

1. 首先渲染不透明的物体，得到 G-buffer
2. 渲染水晶的背面，单独的 buffer，存储其折射参数：折射率，颜色，normal
3. 渲染水晶的正面，先用 ray-march 的方法寻找是否和背面相交；然后计算出射光线的方向，再和场景求交。

总结一下：需要进行 2 次的 ray-march

**植被**


```cardlink
url: https://www.youtube.com/watch?v=Y0Ko0kvwfgA
title: "How Do Games Render So Much Grass?"
description: "An overview of my grass rendering explorations and an implementation of billboard grass, a common technique used in nearly every single video game.Support me..."
host: www.youtube.com
favicon: https://www.youtube.com/s/desktop/5708b2cc/img/favicon_32x32.png
image: https://i.ytimg.com/vi/Y0Ko0kvwfgA/maxresdefault.jpg
```



```cardlink
url: https://www.youtube.com/watch?v=Y0Ko0kvwfgA
title: "How Do Games Render So Much Grass?"
description: "An overview of my grass rendering explorations and an implementation of billboard grass, a common technique used in nearly every single video game.Support me..."
host: www.youtube.com
favicon: https://www.youtube.com/s/desktop/5708b2cc/img/favicon_32x32.png
image: https://i.ytimg.com/vi/Y0Ko0kvwfgA/maxresdefault.jpg
```



```cardlink
url: https://zhuanlan.zhihu.com/p/29632347?utm_medium=social&utm_oi=551847284401283072&utm_psn=1544306957577564162&utm_source=ZHShareTargetIDMore
title: "利用GPU实现无尽草地的实时渲染"
description: "0x00 前言在游戏中展现一个写实的田园场景时，草地的渲染是必不可少的，而一提到高效率的渲染草地，很多人都会想起GPU Gems第七章 《Chapter 7. Rendering Countless Blades of Waving Grass》[1]中所提到的方案。…"
host: zhuanlan.zhihu.com
image: https://pic1.zhimg.com/v2-adb62422e1608d4276fb11807609b65c_r.jpg?source=172ae18b
```



```cardlink
url: https://www.zhihu.com/question/271474165/answer/362260822?utm_medium=social&utm_oi=551847284401283072&utm_psn=1551061052397428736&utm_source=ZHShareTargetIDMore
title: "《塞尔达传说：旷野之息》中的草是如何渲染的？ - 知乎"
description: "主要的思路: LOD，Instancing，拉长的Quad蓝色(包括蓝绿色)部分是随风动的草，红色是不动的草体贴片，蓝…"
host: www.zhihu.com
```


### **AO**


```cardlink
url: https://zhuanlan.zhihu.com/p/549146091?utm_medium=social&utm_oi=551847284401283072&utm_psn=1537961547694993408&utm_source=ZHShareTargetIDMore
title: "写写简单的HBAO"
description: "(Github正常排版: 写写简单的HBAO)0. 起因 URP有SSAO, HDRP有GTAO. 所以摆烂学一个HBAO. 官方的Github地址下面是效果图. 下面是URP的SSAO. 可以发现HBAO会软很多, 慢慢淡出. 下面是自己写的GTAO, 调参没有调对. GT…"
host: zhuanlan.zhihu.com
image: https://pica.zhimg.com/v2-6493411ec81f3378f97d8930fd7feae8_720w.jpg?source=172ae18b
```



```cardlink
url: https://zhuanlan.zhihu.com/p/549146091?utm_medium=social&utm_oi=551847284401283072&utm_psn=1537961547694993408&utm_source=ZHShareTargetIDMore
title: "写写简单的HBAO"
description: "(Github正常排版: 写写简单的HBAO)0. 起因 URP有SSAO, HDRP有GTAO. 所以摆烂学一个HBAO. 官方的Github地址下面是效果图. 下面是URP的SSAO. 可以发现HBAO会软很多, 慢慢淡出. 下面是自己写的GTAO, 调参没有调对. GT…"
host: zhuanlan.zhihu.com
image: https://pic1.zhimg.com/v2-6493411ec81f3378f97d8930fd7feae8_720w.jpg?source=172ae18b
```



```cardlink
url: https://zhuanlan.zhihu.com/p/342210503?utm_medium=social&utm_oi=551847284401283072&utm_psn=1550846700931190784&utm_source=ZHShareTargetIDMore
title: "实时渲染器开发(四) GTAO原理与实践"
description: "目前比较流行的SSAO主要这样三种: SSAO, HBAO, GTAO. 出于学习目的, 我决定尝试自己实现一下GTAO. GTAO的原理通常为了使渲染环境光结果更加真实，我们需要考虑物体周围的环境对环境光的遮挡效果（比如在墙角通常很…"
host: zhuanlan.zhihu.com
```



```cardlink
url: https://zhuanlan.zhihu.com/p/460444838?utm_medium=social&utm_oi=551847284401283072&utm_psn=1553354868148117504&utm_source=ZHShareTargetIDMore
title: "Capsule AO 的实现"
description: "需求效果在非直接光照的环境中能表现出动态物体的阴影。 本质为环境光遮罩问题，在无法使用实时的Global Illumination的情况下使用近似AO算法来替代，效果图片如下。 实现方案 本节参考自Ambient Occlusion技术方…"
host: zhuanlan.zhihu.com
image: https://pica.zhimg.com/v2-ef6901dcd8c3e4b8f23033da83a946ef_720w.jpg?source=172ae18b
```


**为什么 Geometry Shader 很慢**


```cardlink
url: http://www.joshbarczak.com/blog/?p=667
title: "Why Geometry Shaders Are Slow (Unless you’re Intel) – The Burning Basis Vector"
host: www.joshbarczak.com
```


**噪声**


```cardlink
url: https://zhuanlan.zhihu.com/p/68507311?utm_medium=social&utm_oi=551847284401283072&utm_psn=1544284548481097728&utm_source=ZHShareTargetIDMore
title: "WebGL进阶——走进图形噪声"
description: "导语：大自然蕴含着各式各样的纹理，小到细胞菌落分布，大到宇宙星球表面。运用图形噪声，我们可以在3d场景中模拟它们，本文就带大家一起走进万能的图形噪声。概述图形噪声，是计算机图形学中一类随机算法，经常用…"
host: zhuanlan.zhihu.com
image: https://pic1.zhimg.com/v2-4f6277102c4ab765ef93975bd1c97099_720w.jpg?source=172ae18b
```



```cardlink
url: https://zhuanlan.zhihu.com/p/560229938
title: "【shader】超级噪声库，附代码（fbm、Perlin、Simplex、Worley、Tiling、Curl等，很全很全）"
description: "分类1、平平无奇的：一维正弦、白噪声 2、基于晶格的：值噪声、梯度噪声（Gradient、Perlin、Simplex） 3、基于点的：Worley Noise 4、可与其他噪声组合使用的：fbm、Tiling Noise、Curl Noise旋度噪声 5、返回值…"
host: zhuanlan.zhihu.com
image: https://pic1.zhimg.com/v2-89fa9adbc188cbd575bdc3044846f12b_720w.jpg?source=172ae18b
```


（直接使用，原理就那样，体力活）

**后处理**


```cardlink
url: https://www.zhihu.com/question/267044718/answer/2649925830?utm_medium=social&utm_oi=551847284401283072&utm_psn=1548261869001105408&utm_source=ZHShareTargetIDMore
title: "图形学中这种辉光效果叫啥名字？有什么高效实现方式？ - 知乎"
description: "Bloom是一种常见的后处理效果，用来给发光的物体增加光晕。接下来让我们看看如何在Unity中实现它。首先，…"
host: www.zhihu.com
```



```cardlink
url: https://learnopengl.com/Guest-Articles/2022/Phys.-Based-Bloom
title: "LearnOpenGL - Phys. Based Bloom"
description: "Learn OpenGL . com provides good and clear modern 3.3+ OpenGL tutorials with clear examples. A great resource to learn modern OpenGL aimed at beginners."
host: learnopengl.com
```


**旋转**

四元数负担还是太重了，将使用和原理分开来


```cardlink
url: https://www.opengl-tutorial.org/intermediate-tutorials/tutorial-17-quaternions/
title: "Tutorial 17 : Rotations"
description: "Free tutorials for modern Opengl (3.3 and later) in C/C++"
host: www.opengl-tutorial.org
```


**公告板**


```cardlink
url: https://www.opengl-tutorial.org/intermediate-tutorials/billboards-particles/billboards/
title: "Billboards"
description: "Free tutorials for modern Opengl (3.3 and later) in C/C++"
host: www.opengl-tutorial.org
```


**粒子效果**


```cardlink
url: https://www.opengl-tutorial.org/intermediate-tutorials/billboards-particles/particles-instancing/
title: "Particles / Instancing"
description: "Free tutorials for modern Opengl (3.3 and later) in C/C++"
host: www.opengl-tutorial.org
```


**反射探针**

reflection probe

在某个位置捕捉周围所有方向的光照信息，并以 cubemap 的形式存储起来。

当场景动态变化时，只需要更新反射探针即可。

在渲染具有反射材质的物体时，直接套用最近一个反射探针的信息。这样，反射材质可以对场景的动态变化做出反应，且效果较为真实。

- --

skybox 就可以视为一个反射探针。

场景中的所有物体都套用这个反射探针的数据，因为天空实在是太远啦。


```cardlink
url: https://zhuanlan.zhihu.com/p/265463655
title: "游戏中的全局光照(四) Lightmap、LightProbe和Irradiance Volume"
description: "接下来我们来讨论静态GI的漫反射部分，首先需要明确的是，这里的漫反射GI，指的是最后一步是漫反射，而不关心前面的光传播路径是漫反射还是镜面反射。 预计算 Irradiance在前面我们讲环境光照漫反射时，我们提到，…"
host: zhuanlan.zhihu.com
image: https://pica.zhimg.com/v2-a6aba7c0fcd0465551cf1c537ba33ebe_720w.jpg?source=172ae18b
```


这篇文章提到了光照探针


```cardlink
url: https://www.cnblogs.com/KillerAery/p/15335369.html
title: "基于预计算的实时环境光照（Real-time Environment Lighting Based On Precomputation） - KillerAery - 博客园"
description: "概念：环境光照（Environment Lighting） 修正了以前笔记上关于环境光照的错误概念，虽然本来这个环境光照本来也是不那么官方的术语。 全局光照（Global Illumination,G"
host: www.cnblogs.com
```


**骨骼动画**


```cardlink
url: https://learnopengl.com/Guest-Articles/2020/Skeletal-Animation
title: "LearnOpenGL - Skeletal Animation"
description: "Learn OpenGL . com provides good and clear modern 3.3+ OpenGL tutorials with clear examples. A great resource to learn modern OpenGL aimed at beginners."
host: learnopengl.com
```


**杂项**


```cardlink
url: https://www.bilibili.com/video/BV1gU4y1y7Gw?spm_id_from=333.788.top_right_bar_window_view_later.content.click&vd_source=90ca29fbda44ac129a6a601aefa41042
title: "在Unity URP 实现多面视角 Stencil Shaders by Daniel Ilett 2022.1_哔哩哔哩_bilibili"
description: "https://www.youtube.com/watch?v=EzM8LGzMjmc《Antichamber》等游戏采用了不可能的几何结构，即多个物体似乎居住在同一个物理空间中，但只有从特定角度观看时才会出现。我们可以在Unity中使用模板着色器和通用渲染管道的特殊渲染功能重新创建效果!, 视频播放量 1862、弹幕量 0、点赞数 167、投硬币枚数 36、收藏人数 426、转发人数 18, 视频作者 bili_22010753923, 作者简介 VR/AR搬运工unity；不清晰没字幕私信我整改。，相关视频：Breakfast With Unity - Stencil Shaders，Unity AnimationController 状态机入门教程，Unity快速生成真实大地形（新手可用），【Unity教程】如何在Unity当中实现像《Splatoon(喷射战士)》中的墨汁效果【转载搬运】【自翻】，208-unity 阴影设置1【unity2022入门教程】-技术美术入门系列-28，2020/07/15.使用Unity的Stencil功能 完成换装 模型切换等特殊效果，有什么简单好用效果不错的体积光插件推荐下么？ unity URP管线能用的，Unity实现体积雾与体积光，Unity室内场景灯光制作，【Unity教程】如何在Unity当中实现像《塞尔达传说：旷野之息》中的时停能力【转载搬运】【自翻】"
host: www.bilibili.com
image: //i2.hdslb.com/bfs/archive/6e6d8ab3a269aa7e73b7cc160f7e8d42ec64d3b4.png@100w_100h_1c.png
```



```cardlink
url: https://www.bilibili.com/video/BV1vL4y1K7dg?spm_id_from=333.1007.top_right_bar_window_view_later.content.click&vd_source=90ca29fbda44ac129a6a601aefa41042
title: "视差材质模仿niagara特效_哔哩哔哩_bilibili"
description: "视差材质模仿niagara特效, 视频播放量 4351、弹幕量 0、点赞数 228、投硬币枚数 97、收藏人数 463、转发人数 7, 视频作者 EV_LI, 作者简介 常怀感恩之心，做个有情趣的人。，相关视频：虚幻引擎5！制作全息丝带特效效果！，(中英字幕)虚幻引擎5！制作太阳效果！，有这样一款黑科技，只需一步就能制作出超真实室内场景，那就是osl视差贴图，Unity Shader 视差教程 简介有源文件，虚幻5Niagara中文特效入门（更至15动态材质参数...），在Maya里用UE5简直太方便了，那个神器终于可以正式用了，激动人心的新功能：基于视差的置换帖图，分享一个视差贴图的节点组eevee可用，【UE4特效教程 附源码】场景溶解，【UE5】虚幻5实现Niagara雾气效果"
host: www.bilibili.com
image: //i1.hdslb.com/bfs/archive/72f6c11de4e6e6986a84750616567b6b0d217ce8.jpg@100w_100h_1c.png
```


**镶嵌着色器**


```cardlink
url: https://learnopengl.com/Guest-Articles/2021/Tessellation/Tessellation
title: "LearnOpenGL - Tessellation"
description: "Learn OpenGL . com provides good and clear modern 3.3+ OpenGL tutorials with clear examples. A great resource to learn modern OpenGL aimed at beginners."
host: learnopengl.com
```



```cardlink
url: https://blog.csdn.net/qq_35312463/article/details/107120655
title: "Vulkan_曲面细分(Tessellation Shader)_沉默的舞台剧的博客-CSDN博客"
description: "曲面细分本部分我们主要来看一下图形管线中的可选功能：曲面细分。曲面细分靠近管线的最前端，紧挨着顶点着色器之后，它是以图元片(patch)作为输入：每一个都是一个用顶点表示的控制点集合，并把片段分解成更小、更简单的片元，比如点线三角形，从而以正常的方式在管线余下的阶段中渲染。曲面细分是一个管线中可灵活配置的固有功能模块，并且在它的一前一后有两个着色器阶段：表面细分控制着色器（tessellation control shader）和表面细分评估着色器（tessellation evaluation s"
host: blog.csdn.net
```


**计算着色器**


```cardlink
url: https://learnopengl.com/Guest-Articles/2022/Compute-Shaders/Introduction
title: "LearnOpenGL - Introduction"
description: "Learn OpenGL . com provides good and clear modern 3.3+ OpenGL tutorials with clear examples. A great resource to learn modern OpenGL aimed at beginners."
host: learnopengl.com
```


**大气散射**


```cardlink
url: https://zhuanlan.zhihu.com/p/419165090
title: "体渲染探秘（三）天空大气渲染"
description: "一、大气散射的建模一般来说，我们将大气散射分成这样三个部分： A.Rayleigh ScatteringRayleigh 散射是空气中的分子导致的散射，吸收率很低，Rayleigh 散射的相函数的形状大致如下： 通常，我们可以使用如下的公…"
host: zhuanlan.zhihu.com
```


### 全局光照


```cardlink
url: https://zhuanlan.zhihu.com/p/571673961?utm_medium=social&utm_oi=551847284401283072&utm_psn=1564595115846447104&utm_source=ZHShareTargetIDMore
title: "预计算辐照度全局光照（PRTGI）从理论到实战"
description: "抛砖实时全局光照是计算机图形学领域的终极问题之一，是渲染高质量、高保真画面的不二法门，也是无数优秀的科学家和工程师绞尽脑汁不断尝试触摸的圣杯。全局光照分为直接光照和间接光照两个部分，直接光照的计算非…"
host: zhuanlan.zhihu.com
image: https://picd.zhimg.com/v2-e2fd1ce7aa5b64d8bae85f56e6f53d82_720w.jpg?source=172ae18b
```




