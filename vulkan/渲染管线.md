---
tags:
    - vulkan
---


>[!note] Vulkan® 障碍解释 - GPUOpen
[https://gpuopen.com/learn/vulkan-barriers-explained/](https://gpuopen.com/learn/vulkan-barriers-explained/)
Vulkan barriers are unique as they requires you to provide what resources are transitioning and also specify a source and destination pipeline...


## GPU pipeline 的大致样貌

![[_attachments/Pasted image 20221103021621.png|400]]

其中：top 和 botton 纯粹是为了 execution barrier 而存在的，而不是为了 memory barrier 而存在。

为 top 和 bottom 设置 access flag 是没用的

以下代码对应的执行顺序图。这是最慢的屏障

![[_attachments/Pasted image 20221103021643.png|400]]


![[_attachments/Pasted image 20221103021726.png|400]]



另一个场景：
![[_attachments/Pasted image 20221103021741.png|400]]

![[_attachments/Pasted image 20221103021748.png|400]]



G-Buffer 的情景

src = color attachment output

dst = fragment shader

shadow map 情景

src = late fragment test

用到 stage buffer 来 transfer 数据的场景：

src = transfer

dst = 需要的阶段，例如 vertex input


## compute 和 transfer 操作的 pipeline

只有以下 4 个阶段：

![[_attachments/Pasted image 20221103021811.png|400]]

这样看来，整个 pipeline 是一个统一的抽象。

compute，transfer 和 graphcis 分别有执行独立的阶段，三者不会互相干涉

![[_attachments/Pasted image 20221103021826.png|400]]

或许应该对应下图：
![[_attachments/Pasted image 20221103021859.png|400]]


graphics pipelien 的解释

graphics pipeline 可以分为两个部分：
  
![[_attachments/Pasted image 20221103022134.png|400]]

以及：

![[_attachments/Pasted image 20221103022148.png|400]]

值得一提的是：

color attachment output 这个阶段，用于：msaa 解析，framebuffer blend 等操作



另一些图片，通俗易懂

![[_attachments/Pasted image 20221103022205.png|400]]