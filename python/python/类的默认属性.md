[toc]
#### 内置函数接口
##### `__len__()`
让类支持`len()`函数
```python
class MyClass:
    def __len__(self):
        return 3
len(MyClass())
# 3
```
##### `__str__()`
让类支持`print()`函数
```python
class MyClass:
    def __str__(self):
        return "acc"
print(MyClass())
# acc
```
##### `__repr__()`
让类支持`repr()`函数
以及命令行显示
```python
class MyClass:
    def __repr__(self):
        return "acc"
>>> MyClass()
# acc
repr(MyClass())
# acc
```
#### 与`[]`运算符有关
##### `__getitem__()`
让类支持方括号读取值
可以通过下标运算传递任何东西，常见的比如：整型`a[1]`，字符串`a["name"]`，切片对象`a[1: 2]`。（注：切片对象是指`class slice`）
还可以自定义传递什么对象：
```python
class Symbol:
    def __init__(self, content):
        self.content = content
class ShowSymbolName:
    def __getitem__(self, attr):
        if isinstance(attr, Symbol):
            print(attr.content)
ShowSymbolName()[Symbol("acc")]
# acc
```
##### `__setitem__()`
让类支持方括号赋值
##### `__delitem__()`
让类支持方括号删除，如：
```python
del a[1]
```
#### 运算符重载
正向运算符重载：比如`MyClass() + 123`，重载例子：`__add__(self, rhs)`
反向运算符：比如`123 + MyClass()`，重载方法是在加前缀`r`，比如`__radd__`
运算赋值：比如这种形式`MyClass() += 123`，重载方法是增加前缀`i`，比如`__iadd__()`
##### 算数运算符
算数运算符是二元运算符，支持反向运算符重载以及运算赋值重载。

| 运算符 | 重载方法 | 运算符 | 重载方法 |
| --- | --- | --- | --- |
| `+` | `__and__` | `-` | `__sub__` |
| `*` | `__mul__` | `/` | `__truediv__` |
| `//` | `__floordiv__` | `%` | `__mod__` |
| `**`幂运算 | `__pow__` |  |  |

##### 比较运算符
是二元运算符，不支持反向运算符以及运算赋值

| 运算符 | 重载方法 | 运算符 | 重载方法 |
| --- | --- | --- | --- |
| `<` | `__lt__` | `<=` | `__le__` |
| `>` | `__gt__` | `>=` | `__ge__` |
| `==` | `__eq__` | `!=` | `__ne__` |

##### 位运算符（2元）
是二元运算符，支持反向和运算赋值

| 运算符 | 重载方法 | 运算符 | 重载方法 |
| --- | --- | --- | --- |
| 按位与`&` | `__and__` | 按位或 | `__or__` |
| 按位异或`^` | `__xor__` | 左位移`<<` | `__lshift__` |
| 右位移`>>` | `__rshilf__` |  |  |

##### 一元运算符重载
| 运算符 | 重载方法 | 运算符 | 重载方法 |
| --- | --- | --- | --- |
| 负号`-` | `__neg__` | 正号`+` | `__pos__` |
| 按位反`~` | `__invert__` |  |  |

##### `in/not in`运算符
只需要定义`__contains__`方法，就可以让`in`和`not in`都生效
#### `__init__()`
类的构造函数
#### `__doc__`
类的说明性字符串，可以被`help()`函数读取
```python
class MyClass:
    """A simple class"""
    
print(MyClass().__doc__)
# A simple class
```
#### 与属性运算符`.`有关
##### `__slots__`
`python`允许任何时候给类和对象绑定属性，通过`__slots__`属性可以限制这种属性绑定操作：
```python
class MyClass:
    """这个类只允许绑定name和age属性"""
    __slots__ = ("name", "age")
    
c = MyClass()
c.name = "acc"
# OK
c.grade = 12
# AttributeError
```
`__slots__`用于继承时需要再研究。
##### `__getattr__()`
这个方法可以从对象中提取未定义的属性
```python
class MyClass:
    def __getattr__(self, attr):
        if attr == "name":
            return "acc"
        raise AttributeError("can not find attr")
print(MyClass().name)
# acc
```
记住对其他属性抛出异常
##### `__setattr__()`
这个方法可以对对象中未定义的属性进行赋值

---

#### `__call__()`
这个方法让对象变成`callable`的：
```python
class MyClass:
    def __call__(self):
        return "acc"
print(MyClass()())
# acc
```
