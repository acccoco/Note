```lua
EnablePrimaryMouseButtonEvents (true)
local fire = false
local sleep1 = 5
local sleep2 = 10
local auto = false

function OnEvent(event, arg)
  OutputLogMessage("event = %s, arg = %d\n", event, arg)

  if (event == "MOUSE_BUTTON_PRESSED" and arg == 4) then
    auto = not auto
  end


  if (auto and event == "MOUSE_BUTTON_PRESSED" and arg == 1) then
    fire = true
    SetMKeyState(3)
  end

  if (auto and event == "MOUSE_BUTTON_RELEASED" and arg == 1) then
    fire = false
  end

  if (auto and fire and event == "M_RELEASED" and arg == 3) then
    PressMouseButton(1)
    Sleep(sleep1)
    ReleaseMouseButton(1)

    SetMKeyState(3)
    Sleep(sleep2)
  end

end
```
